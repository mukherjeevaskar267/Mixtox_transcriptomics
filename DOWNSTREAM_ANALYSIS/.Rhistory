# WITH GROWTH RELATED GENES
GO_SaPavsPara_SC_all <- SaPavsPara_SC_des[which(abs(SaPavsPara_SC_des$log2FoldChange) >= 1
& SaPavsPara_SC_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaPavsPara_SC_up <- SaPavsPara_SC_des[which(SaPavsPara_SC_des$log2FoldChange>= 1
& SaPavsPara_SC_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaPavsPara_SC_down <- SaPavsPara_SC_des[which(SaPavsPara_SC_des$log2FoldChange <= -1
& SaPavsPara_SC_des$padj <= 0.05), "SGD_DB_ID"]
# WITHOUT GROWTH RELATED GENES
GO_SaPavsPara_SC_all_wo_GRG <- SaPavsPara_SC_des[which((abs(SaPavsPara_SC_des$log2FoldChange) >= 1 & SaPavsPara_SC_des$padj <= 0.05)
& !(SaPavsPara_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaPavsPara_SC_up_wo_GRG <- SaPavsPara_SC_des[which((SaPavsPara_SC_des$log2FoldChange >= 1 & SaPavsPara_SC_des$padj <= 0.05)
& !(SaPavsPara_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaPavsPara_SC_down_wo_GRG <- SaPavsPara_SC_des[which((SaPavsPara_SC_des$log2FoldChange <= -1 & SaPavsPara_SC_des$padj <= 0.05)
& !(SaPavsPara_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
#WRITE TABLE
#Eg. write.table(GO_SaPavsPara_SC_all, file = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_SaPavsPara_SC_all.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
# WITH GROWTH RELATED GENES
GO_SaPavsPara_DH_all <- SaPavsPara_DH_des[which(abs(SaPavsPara_DH_des$log2FoldChange) >= 1
& SaPavsPara_DH_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaPavsPara_DH_up <- SaPavsPara_DH_des[which(SaPavsPara_DH_des$log2FoldChange>= 1
& SaPavsPara_DH_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaPavsPara_DH_down <- SaPavsPara_DH_des[which(SaPavsPara_DH_des$log2FoldChange <= -1
& SaPavsPara_DH_des$padj <= 0.05), "SGD_DB_ID"]
# WITHOUT GROWTH RELATED GENES
GO_SaPavsPara_DH_all_wo_GRG <- SaPavsPara_DH_des[which((abs(SaPavsPara_DH_des$log2FoldChange) >= 1 & SaPavsPara_DH_des$padj <= 0.05)
& !(SaPavsPara_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaPavsPara_DH_up_wo_GRG <- SaPavsPara_DH_des[which((SaPavsPara_DH_des$log2FoldChange >= 1 & SaPavsPara_DH_des$padj <= 0.05)
& !(SaPavsPara_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaPavsPara_DH_down_wo_GRG <- SaPavsPara_DH_des[which((SaPavsPara_DH_des$log2FoldChange <= -1 & SaPavsPara_DH_des$padj <= 0.05)
& !(SaPavsPara_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
#WRITE TABLE
#write.table(GO_SaPavsPara_DH_all_wo_GRG, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/GO_SaPavsPara_DH_all_wo_GRG.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
# WITH GROWTH RELATED GENES
GO_SaRavsSalt_SC_all <- SaRavsSalt_SC_des[which(abs(SaRavsSalt_SC_des$log2FoldChange) >= 1
& SaRavsSalt_SC_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaRavsSalt_SC_up <- SaRavsSalt_SC_des[which(SaRavsSalt_SC_des$log2FoldChange>= 1
& SaRavsSalt_SC_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaRavsSalt_SC_down <- SaRavsSalt_SC_des[which(SaRavsSalt_SC_des$log2FoldChange <= -1
& SaRavsSalt_SC_des$padj <= 0.05), "SGD_DB_ID"]
# WITHOUT GROWTH RELATED GENES
GO_SaRavsSalt_SC_all_wo_GRG <- SaRavsSalt_SC_des[which((abs(SaRavsSalt_SC_des$log2FoldChange) >= 1 & SaRavsSalt_SC_des$padj <= 0.05)
& !(SaRavsSalt_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaRavsSalt_SC_up_wo_GRG <- SaRavsSalt_SC_des[which((SaRavsSalt_SC_des$log2FoldChange >= 1 & SaRavsSalt_SC_des$padj <= 0.05)
& !(SaRavsSalt_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaRavsSalt_SC_down_wo_GRG <- SaRavsSalt_SC_des[which((SaRavsSalt_SC_des$log2FoldChange <= -1 & SaRavsSalt_SC_des$padj <= 0.05)
& !(SaRavsSalt_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
#WRITE TABLE
#Eg. write.table(GO_SaRavsSalt_SC_all, file = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_SaRavsSalt_SC_all.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
# WITH GROWTH RELATED GENES
GO_SaRavsSalt2_DH_all <- SaRavsSalt2_DH_des[which(abs(SaRavsSalt2_DH_des$log2FoldChange) >= 1
& SaRavsSalt2_DH_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaRavsSalt2_DH_up <- SaRavsSalt2_DH_des[which(SaRavsSalt2_DH_des$log2FoldChange>= 1
& SaRavsSalt2_DH_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaRavsSalt2_DH_down <- SaRavsSalt2_DH_des[which(SaRavsSalt2_DH_des$log2FoldChange <= -1
& SaRavsSalt2_DH_des$padj <= 0.05), "SGD_DB_ID"]
# WITHOUT GROWTH RELATED GENES
GO_SaRavsSalt2_DH_all_wo_GRG <- SaRavsSalt2_DH_des[which((abs(SaRavsSalt2_DH_des$log2FoldChange) >= 1 & SaRavsSalt2_DH_des$padj <= 0.05)
& !(SaRavsSalt2_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaRavsSalt2_DH_up_wo_GRG <- SaRavsSalt2_DH_des[which((SaRavsSalt2_DH_des$log2FoldChange >= 1 & SaRavsSalt2_DH_des$padj <= 0.05)
& !(SaRavsSalt2_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaRavsSalt2_DH_down_wo_GRG <- SaRavsSalt2_DH_des[which((SaRavsSalt2_DH_des$log2FoldChange <= -1 & SaRavsSalt2_DH_des$padj <= 0.05)
& !(SaRavsSalt2_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
#WRITE TABLE
#write.table(GO_SaRavsSalt2_DH_all_wo_GRG, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/GO_SaRavsSalt2_DH_all_wo_GRG.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
# WITH GROWTH RELATED GENES
GO_SaRavsRapa_SC_all <- SaRavsRapa_SC_des[which(abs(SaRavsRapa_SC_des$log2FoldChange) >= 1
& SaRavsRapa_SC_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaRavsRapa_SC_up <- SaRavsRapa_SC_des[which(SaRavsRapa_SC_des$log2FoldChange>= 1
& SaRavsRapa_SC_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaRavsRapa_SC_down <- SaRavsRapa_SC_des[which(SaRavsRapa_SC_des$log2FoldChange <= -1
& SaRavsRapa_SC_des$padj <= 0.05), "SGD_DB_ID"]
# WITHOUT GROWTH RELATED GENES
GO_SaRavsRapa_SC_all_wo_GRG <- SaRavsRapa_SC_des[which((abs(SaRavsRapa_SC_des$log2FoldChange) >= 1 & SaRavsRapa_SC_des$padj <= 0.05)
& !(SaRavsRapa_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaRavsRapa_SC_up_wo_GRG <- SaRavsRapa_SC_des[which((SaRavsRapa_SC_des$log2FoldChange >= 1 & SaRavsRapa_SC_des$padj <= 0.05)
& !(SaRavsRapa_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaRavsRapa_SC_down_wo_GRG <- SaRavsRapa_SC_des[which((SaRavsRapa_SC_des$log2FoldChange <= -1 & SaRavsRapa_SC_des$padj <= 0.05)
& !(SaRavsRapa_SC_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
#WRITE TABLE
#Eg. write.table(GO_SaRavsRapa_SC_all, file = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_SaRavsRapa_SC_all.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
# WITH GROWTH RELATED GENES
GO_SaRavsRapa_DH_all <- SaRavsRapa_DH_des[which(abs(SaRavsRapa_DH_des$log2FoldChange) >= 1
& SaRavsRapa_DH_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaRavsRapa_DH_up <- SaRavsRapa_DH_des[which(SaRavsRapa_DH_des$log2FoldChange>= 1
& SaRavsRapa_DH_des$padj <= 0.05), "SGD_DB_ID"]
GO_SaRavsRapa_DH_down <- SaRavsRapa_DH_des[which(SaRavsRapa_DH_des$log2FoldChange <= -1
& SaRavsRapa_DH_des$padj <= 0.05), "SGD_DB_ID"]
# WITHOUT GROWTH RELATED GENES
GO_SaRavsRapa_DH_all_wo_GRG <- SaRavsRapa_DH_des[which((abs(SaRavsRapa_DH_des$log2FoldChange) >= 1 & SaRavsRapa_DH_des$padj <= 0.05)
& !(SaRavsRapa_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaRavsRapa_DH_up_wo_GRG <- SaRavsRapa_DH_des[which((SaRavsRapa_DH_des$log2FoldChange >= 1 & SaRavsRapa_DH_des$padj <= 0.05)
& !(SaRavsRapa_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
GO_SaRavsRapa_DH_down_wo_GRG <- SaRavsRapa_DH_des[which((SaRavsRapa_DH_des$log2FoldChange <= -1 & SaRavsRapa_DH_des$padj <= 0.05)
& !(SaRavsRapa_DH_des$SGD_DB_ID %in% GRG_ALL_SGD_DB_ID)), "SGD_DB_ID"]
#WRITE TABLE
write.table(GO_SaRavsRapa_DH_all_wo_GRG, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/GO_SaRavsRapa_DH_all_wo_GRG.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaPa_up_DH <- setdiff(intersect(GO_SaPavsPara_DH_up_wo_GRG, GO_SaPavsSalt1_DH_up_wo_GRG),
union(GO_para_DH_up_wo_GRG, GO_salt1_DH_up_wo_GRG))
length(Uniq_SaPa_up_DH)
write.table(Uniq_SaPa_up_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Uniq_SaPa_UP_DH.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaPa_up_DH
write.table(Uniq_SaPa_up_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Uniq_SaPa_UP_DH.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaPa_DH_up_des <- Gene_Description_SC[(Gene_Description_SC$SGD_DB_ID %in% as.character(Uniq_SaPa_up_DH)), ]
str(Uniq_SaPa_DH_up_des)
Uniq_SaPa_DH_up_des <- cbind(Uniq_SaPa_DH_up_des,
salt1_DH[as.character(Uniq_SaPa_DH_up_des$SYS_ID), c(2,6)],
para_DH[as.character(Uniq_SaPa_DH_up_des$SYS_ID), c(2,6)],
SaPa_DH[as.character(Uniq_SaPa_DH_up_des$SYS_ID), c(2,6)])
write.table(Uniq_SaPa_DH_up_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaPa_DH_UP_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
str(Uniq_SaPa_DH_up_des)
Uniq_SaPa_DH_up_des <- Gene_Description_SC[(Gene_Description_SC$SGD_DB_ID %in% as.character(Uniq_SaPa_up_DH)), ]
str(Uniq_SaPa_DH_up_des)
Uniq_SaPa_DH_up_des <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(Uniq_SaPa_up_DH)), ]
str(Uniq_SaPa_DH_up_des)
Uniq_SaPa_DH_up_des <- cbind(Uniq_SaPa_DH_up_des,
salt1_DH[as.character(Uniq_SaPa_DH_up_des$SYS_ID), c(2,6)],
para_DH[as.character(Uniq_SaPa_DH_up_des$SYS_ID), c(2,6)],
SaPa_DH[as.character(Uniq_SaPa_DH_up_des$SYS_ID), c(2,6)])
write.table(Uniq_SaPa_DH_up_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaPa_DH_UP_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
write.csv(Uniq_SaPa_SC_up_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaPa_SC_up_des.csv", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
write.table(Uniq_SaPa_SC_up_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaPa_SC_up_des.csv", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Uniq_SaPa_down_DH <- setdiff(intersect(GO_SaPavsPara_DH_down_wo_GRG, GO_SaPavsSalt1_DH_down_wo_GRG),
union(GO_para_DH_down_wo_GRG, GO_salt1_DH_down_wo_GRG))
length(Uniq_SaPa_down_DH)
write.table(Uniq_SaPa_down_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Uniq_SaPa_down_DH.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaPa_DH_down_des <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(Uniq_SaPa_down_DH)), ]
str(Uniq_SaPa_DH_down_des)
Uniq_SaPa_DH_down_des <- cbind(Uniq_SaPa_DH_down_des,
salt1_DH[as.character(Uniq_SaPa_DH_down_des$SYS_ID), c(2,6)],
para_DH[as.character(Uniq_SaPa_DH_down_des$SYS_ID), c(2,6)],
SaPa_DH[as.character(Uniq_SaPa_DH_down_des$SYS_ID), c(2,6)])
write.table(Uniq_SaPa_DH_down_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaPa_DH_down_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Uniq_list_SaPa_up_DH <- list(GO_SaPavsSalt1_DH_up_wo_GRG,
GO_salt1_DH_up_wo_GRG,
GO_para_DH_up_wo_GRG,
GO_SaPavsPara_DH_up_wo_GRG)
names(Uniq_list_SaPa_up_DH) <- c("SP_S","S","P","SP_P")
ggvenn(Uniq_list_SaPa_up_DH,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
Uniq_list_SaPa_down_DH <- list(GO_SaPavsSalt1_DH_down_wo_GRG,
GO_salt1_DH_down_wo_GRG,
GO_para_DH_down_wo_GRG,
GO_SaPavsPara_DH_down_wo_GRG)
names(Uniq_list_SaPa_down_DH) <- c("SP_S","S","P","SP_P")
ggvenn(Uniq_list_SaPa_down_DH,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
length(Uniq_SaPa_down_DH)
ggvenn(Uniq_list_SaPa_up_DH,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
ggvenn(Uniq_list_SaPa_up_DH,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
Intersect_SaPa_up_DH <- intersect(GO_SaPavsPara_DH_up_wo_GRG, GO_SaPavsSalt1_DH_up_wo_GRG)
length(Intersect_SaPa_up_DH)
write.table(Intersect_SaPa_up_DH, file = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_Input_wo_GRG/Intersect_SaPa_UP_DH.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
write.table(Intersect_SaPa_up_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Intersect_SaPa_DH_UP.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Intersect_SaPa_up_des_DH <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(Intersect_SaPa_up_DH)), ]
str(Intersect_SaPa_up_des_DH)
Intersect_SaPa_up_des_DH <- cbind(Intersect_SaPa_up_des_DH,
salt1_DH[as.character(Intersect_SaPa_up_des_DH$SYS_ID), c(2,6)],
para_DH[as.character(Intersect_SaPa_up_des_DH$SYS_ID), c(2,6)],
SaPa_DH[as.character(Intersect_SaPa_up_des_DH$SYS_ID), c(2,6)])
write.table(Intersect_SaPa_up_des_DH, file = "COMPILED_DATA/SET_DIFFERENCE/Intersect_SaPa_DH_up_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
length(Uniq_SaRa_up_DH)
head(Uniq_SaRa_DH_up_des)
length(Uniq_SaRa_down_DH)
length(Uniq_SaRa_down )
knitr::opts_chunk$set(echo = TRUE)
length(Uniq_SaRa_up)
length(Intersect_SaPa_down_DH)
length(Uniq_SaPa_down_DH)
# {(SaPa vs Salt) ∩ (SaPa vs Para)}
Intersect_SaPa_up_DH <- intersect(GO_SaPavsPara_DH_up_wo_GRG, GO_SaPavsSalt1_DH_up_wo_GRG)
length(Intersect_SaPa_up_DH)
write.table(Intersect_SaPa_up_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Intersect_SaPa_DH_UP.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Intersect_SaPa_up_des_DH <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(na.omit(Intersect_SaPa_up_DH))), ]
str(Intersect_SaPa_up_des_DH)
Intersect_SaPa_up_des_DH <- cbind(Intersect_SaPa_up_des_DH,
salt1_DH[as.character(Intersect_SaPa_up_des_DH$SYS_ID), c(2,6)],
para_DH[as.character(Intersect_SaPa_up_des_DH$SYS_ID), c(2,6)],
SaPa_DH[as.character(Intersect_SaPa_up_des_DH$SYS_ID), c(2,6)])
#write.table(Intersect_SaPa_up_des_DH, file = "COMPILED_DATA/SET_DIFFERENCE/Intersect_SaPa_DH_up_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
length(Intersect_SaPa_up_DH)
Intersect_list_SaPa_up_DH <- list(GO_SaPavsSalt1_DH_up_wo_GRG,
GO_SaPavsPara_DH_up_wo_GRG)
library(ggvenn)
names(Intersect_list_SaPa_up_DH) <- c("SP_S","SP_P")
ggvenn(Intersect_list_SaPa_up_DH,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
str(Intersect_SaPa_up_des_DH)
str(Intersect_SaPa_down_des_DH)
# {(SaPa vs Salt) ∩ (SaPa vs Para)}
Intersect_SaPa_down_DH <- intersect(GO_SaPavsPara_DH_down_wo_GRG, GO_SaPavsSalt1_DH_down_wo_GRG)
length(Intersect_SaPa_down_DH)
#write.table(Intersect_SaPa_down_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Intersect_SaPa_DH_down.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Intersect_SaPa_down_des_DH <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(na.omit(Intersect_SaPa_down_DH))), ]
str(Intersect_SaPa_down_des_DH)
Intersect_SaPa_down_des_DH <- cbind(Intersect_SaPa_down_des_DH,
salt1_DH[as.character(Intersect_SaPa_down_des_DH$SYS_ID), c(2,6)],
para_DH[as.character(Intersect_SaPa_down_des_DH$SYS_ID), c(2,6)],
SaPa_DH[as.character(Intersect_SaPa_down_des_DH$SYS_ID), c(2,6)])
#write.table(Intersect_SaPa_down_des_DH, file = "COMPILED_DATA/SET_DIFFERENCE/Intersect_SaPa_DHdown_des_DH.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Intersect_list_SaPa_down_DH <- list(GO_SaPavsSalt1_DH_down_wo_GRG,
GO_SaPavsPara_DH_down_wo_GRG)
library(ggvenn)
names(Intersect_list_SaPa_down_DH) <- c("SP_S","SP_P")
ggvenn(Intersect_list_SaPa_down_DH,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
# [{(SaRa vs Salt) ∩ (SaRa vs RaPa)} \ {(Salt vs Ctrl) U (RaPa vs Ctrl)}]
Uniq_SaRa_up <- setdiff(intersect(GO_SaRavsRapa_SC_up_wo_GRG, GO_SaRavsSalt_SC_up_wo_GRG),
union(GO_rapa_SC_up_wo_GRG, GO_salt_SC_up_wo_GRG))
length(Uniq_SaRa_up)
#WRITE TABLE
#write.table(Uniq_SaRa_up, file = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_Input_wo_GRG/Uniq_SaRa_SC_UP.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaRa_SC_up_des <- Gene_Description_SC[(Gene_Description_SC$SGD_DB_ID %in% as.character(Uniq_SaRa_up)), ]
str(Uniq_SaRa_SC_up_des)
Uniq_SaRa_SC_up_des <- cbind(Uniq_SaRa_SC_up_des,
salt_SC[as.character(Uniq_SaRa_SC_up_des$SYS_ID), c(2,6)],
rapa_SC[as.character(Uniq_SaRa_SC_up_des$SYS_ID), c(2,6)],
SaRa_SC[as.character(Uniq_SaRa_SC_up_des$SYS_ID), c(2,6)])
#write.table(Uniq_SaRa_SC_up_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaRa_SC_up_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Uniq_list_SaRa_up <- list(GO_SaRavsSalt_SC_up_wo_GRG,
GO_salt_SC_up_wo_GRG,
GO_rapa_SC_up_wo_GRG,
GO_SaRavsRapa_SC_up_wo_GRG)
library(ggvenn)
names(Uniq_list_SaRa_up) <- c("SR_S","S","R","SR_R")
ggvenn(Uniq_list_SaRa_up,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
# [{(SaRa vs Salt) ∩ (SaRa vs RaPa)} \ {(Salt vs Ctrl) U (RaPa vs Ctrl)}]
Uniq_SaRa_up <- setdiff(intersect(GO_SaRavsRapa_SC_up_wo_GRG, GO_SaRavsSalt_SC_up_wo_GRG),
union(GO_rapa_SC_up_wo_GRG, GO_salt_SC_up_wo_GRG))
length(Uniq_SaRa_up)
#WRITE TABLE
#write.table(Uniq_SaRa_up, file = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_Input_wo_GRG/Uniq_SaRa_SC_UP.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaRa_SC_up_des <- Gene_Description_SC[(Gene_Description_SC$SGD_DB_ID %in% as.character(Uniq_SaRa_up)), ]
str(Uniq_SaRa_SC_up_des)
Uniq_SaRa_SC_up_des <- cbind(Uniq_SaRa_SC_up_des,
salt_SC[as.character(Uniq_SaRa_SC_up_des$SYS_ID), c(2,6)],
rapa_SC[as.character(Uniq_SaRa_SC_up_des$SYS_ID), c(2,6)],
SaRa_SC[as.character(Uniq_SaRa_SC_up_des$SYS_ID), c(2,6)])
#write.table(Uniq_SaRa_SC_up_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaRa_SC_up_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
length(Uniq_SaRa_up)
knitr::opts_chunk$set(echo = TRUE)
length(Intersect_SaPa_up_DH)
length(Intersect_SaPa_down_DH)
length(Uniq_SaRa_up)
length(Uniq_SaRa_down)
# [{(SaRa vs Salt) ∩ (SaRa vs Rapa)} \ {(Salt vs Ctrl) U (Rapa vs Ctrl)}]
Uniq_SaRa_down <- setdiff(intersect(GO_SaRavsRapa_SC_down_wo_GRG, GO_SaRavsSalt_SC_down_wo_GRG),
union(GO_rapa_SC_down_wo_GRG, GO_salt_SC_down_wo_GRG))
length(Uniq_SaRa_down)
#WRITE TABLE
#write.table(Uniq_SaRa_down, file = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_Input_wo_GRG/Uniq_SaRa_SC_down.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaRa_SC_down_des <- Gene_Description_SC[(Gene_Description_SC$SGD_DB_ID %in% as.character(Uniq_SaRa_down)), ]
str(Uniq_SaRa_SC_down_des)
Uniq_SaRa_SC_down_des <- cbind(Uniq_SaRa_SC_down_des,
salt_SC[as.character(Uniq_SaRa_SC_down_des$SYS_ID), c(2,6)],
rapa_SC[as.character(Uniq_SaRa_SC_down_des$SYS_ID), c(2,6)],
SaRa_SC[as.character(Uniq_SaRa_SC_down_des$SYS_ID), c(2,6)])
#write.table(Uniq_SaRa_SC_down_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaRa_SC_down_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
length(Uniq_SaRa_down)
knitr::opts_chunk$set(echo = TRUE)
length(Intersect_SaPa_down_DH)
length(Uniq_SaRa_up)
length(Uniq_SaRa_down)
length(Intersect_SaRa_up)
Intersect_SaRa_up <- intersect(GO_SaRavsRapa_SC_up_wo_GRG, GO_SaRavsSalt_SC_up_wo_GRG)
length(Intersect_SaRa_up)
Intersect_SaRa_up_des <- Gene_Description_SC[(Gene_Description_SC$SGD_DB_ID %in% as.character(Intersect_SaRa_up)), ]
str(Intersect_SaRa_up_des)
Intersect_SaRa_up_des <- cbind(Intersect_SaRa_up_des,
salt_SC[as.character(Intersect_SaRa_up_des$SYS_ID), c(2,6)],
rapa_SC[as.character(Intersect_SaRa_up_des$SYS_ID), c(2,6)],
SaRa_SC[as.character(Intersect_SaRa_up_des$SYS_ID), c(2,6)])
write.table(Intersect_SaRa_up_des, file = "COMPILED_DATA/SET_DIFFERENCE/Intersect_SaRa_SC_up_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Intersect_list_SaRa_up <- list(GO_SaRavsSalt_SC_up_wo_GRG,
GO_SaRavsRapa_SC_up_wo_GRG)
library(ggvenn)
names(Intersect_list_SaRa_up) <- c("SP_S","SP_P")
ggvenn(Intersect_list_SaRa_up,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
library(ggvenn)
names(Uniq_list_SaRa_down) <- c("SP_S","S","P","SP_P")
ggvenn(Uniq_list_SaRa_down,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
Intersect_list_SaPa_down_DH <- list(GO_SaPavsSalt1_DH_down_wo_GRG,
GO_SaPavsPara_DH_down_wo_GRG)
library(ggvenn)
names(Intersect_list_SaPa_down_DH) <- c("SP_S","SP_P")
ggvenn(Intersect_list_SaPa_down_DH,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
library(ggvenn)
names(Intersect_list_SaPa_down_DH) <- c("SP_S","SP_P")
ggvenn(Intersect_list_SaPa_down_DH,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
str(Uniq_SaRa_SC_up_des)
library(ggvenn)
names(Uniq_list_SaRa_up) <- c("SR_S","S","R","SR_R")
ggvenn(Uniq_list_SaRa_up,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
Uniq_list_SaRa_down <- list(GO_SaRavsSalt_SC_down_wo_GRG,
GO_salt_SC_down_wo_GRG,
GO_rapa_SC_down_wo_GRG,
GO_SaRavsRapa_SC_down_wo_GRG)
library(ggvenn)
names(Uniq_list_SaRa_down) <- c("SR_S","S","R","SR_R")
ggvenn(Uniq_list_SaRa_down,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
str(Intersect_SaRa_up_des)
length(Intersect_SaRa_up)
Intersect_list_SaRa_up <- list(GO_SaRavsSalt_SC_up_wo_GRG,
GO_SaRavsRapa_SC_up_wo_GRG)
library(ggvenn)
names(Intersect_list_SaRa_up) <- c("SP_S","SP_P")
ggvenn(Intersect_list_SaRa_up,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
Intersect_SaRa_down <- intersect(GO_SaRavsRapa_SC_down_wo_GRG, GO_SaRavsSalt_SC_down_wo_GRG)
length(Intersect_SaRa_down)
Intersect_SaRa_down <- intersect(GO_SaRavsRapa_SC_down_wo_GRG, GO_SaRavsSalt_SC_down_wo_GRG)
length(Intersect_SaRa_down)
write.table(Intersect_SaRa_down, file = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_Input_wo_GRG/Intersect_SaRa_SC_down.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Intersect_SaRa_down_des <- Gene_Description_SC[(Gene_Description_SC$SGD_DB_ID %in% as.character(Intersect_SaRa_down)), ]
str(Intersect_SaRa_down_des)
Intersect_SaRa_down_des <- cbind(Intersect_SaRa_down_des,
salt_SC[as.character(Intersect_SaRa_down_des$SYS_ID), c(2,6)],
rapa_SC[as.character(Intersect_SaRa_down_des$SYS_ID), c(2,6)],
SaRa_SC[as.character(Intersect_SaRa_down_des$SYS_ID), c(2,6)])
write.table(Intersect_SaRa_down_des, file = "COMPILED_DATA/SET_DIFFERENCE/Intersect_SaRa_SC_down_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Intersect_list_SaRa_down <- list(GO_SaRavsSalt_SC_down_wo_GRG,
GO_SaRavsRapa_SC_down_wo_GRG)
library(ggvenn)
names(Intersect_list_SaRa_down) <- c("SR_S","SR_R")
ggvenn(Intersect_list_SaRa_down,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
Uniq_SaRa_up_DH <- setdiff(intersect(GO_SaRavsRapa_DH_up_wo_GRG, GO_SaRavsSalt2_DH_up_wo_GRG),
union(GO_rapa_DH_up_wo_GRG, GO_salt2_DH_up_wo_GRG))
length(Uniq_SaRa_up_DH)
knitr::opts_chunk$set(echo = TRUE)
length(Uniq_SaRa_up_DH)
write.table(Uniq_SaRa_up_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Uniq_SaRa_DH_UP.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaRa_DH_up_des <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(Uniq_SaRa_up_DH)), ]
str(Uniq_SaRa_DH_up_des)
Uniq_SaRa_DH_up_des <- cbind(Uniq_SaRa_DH_up_des,
salt2_DH[as.character(Uniq_SaRa_DH_up_des$SYS_ID), c(2,6)],
rapa_DH[as.character(Uniq_SaRa_DH_up_des$SYS_ID), c(2,6)],
SaRa_DH[as.character(Uniq_SaRa_DH_up_des$SYS_ID), c(2,6)])
write.table(Uniq_SaRa_DH_up_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaRa_DH_UP_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Uniq_list_SaRa_up_DH <- list(GO_SaRavsSalt2_DH_up_wo_GRG,
GO_salt2_DH_up_wo_GRG,
GO_rapa_DH_up_wo_GRG,
GO_SaRavsRapa_DH_up_wo_GRG)
library(ggvenn)
names(Uniq_list_SaRa_up_DH) <- c("SR_S","S","R","SR_R")
ggvenn(Uniq_list_SaRa_up_DH,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
Uniq_SaRa_down_DH <- setdiff(intersect(GO_SaRavsRapa_DH_down_wo_GRG, GO_SaRavsSalt2_DH_down_wo_GRG),
union(GO_rapa_DH_down_wo_GRG, GO_salt2_DH_down_wo_GRG))
length(Uniq_SaRa_down_DH)
write.table(Uniq_SaRa_down_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Uniq_SaRa_DH_down.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Uniq_SaRa_DH_down_des <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(Uniq_SaRa_down_DH)), ]
str(Uniq_SaRa_DH_down_des)
Uniq_SaRa_DH_down_des <- cbind(Uniq_SaRa_DH_down_des,
salt2_DH[as.character(Uniq_SaRa_DH_down_des$SYS_ID), c(2,6)],
rapa_DH[as.character(Uniq_SaRa_DH_down_des$SYS_ID), c(2,6)],
SaRa_DH[as.character(Uniq_SaRa_DH_down_des$SYS_ID), c(2,6)])
write.table(Uniq_SaRa_DH_down_des, file = "COMPILED_DATA/SET_DIFFERENCE/Uniq_SaRa_DH_down_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Uniq_list_SaRa_down_DH <- list(GO_SaRavsSalt2_DH_down_wo_GRG,
GO_salt2_DH_down_wo_GRG,
GO_rapa_DH_down_wo_GRG,
GO_SaRavsRapa_DH_down_wo_GRG)
library(ggvenn)
names(Uniq_list_SaRa_down_DH) <- c("SR_S","S","R","SR_R")
ggvenn(Uniq_list_SaRa_down_DH,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
Intersect_SaRa_up_DH <- intersect(GO_SaRavsRapa_DH_up_wo_GRG, GO_SaRavsSalt2_DH_up_wo_GRG)
length(Intersect_SaRa_up_DH)
write.table(Intersect_SaRa_up_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Intersect_SaRa_DH_UP.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Intersect_SaRa_up_des_DH <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(na.omit(Intersect_SaRa_up_DH))), ]
str(Intersect_SaRa_up_des_DH)
Intersect_SaRa_up_des_DH <- cbind(Intersect_SaRa_up_des_DH,
salt2_DH[as.character(Intersect_SaRa_up_des_DH$SYS_ID), c(2,6)],
rapa_DH[as.character(Intersect_SaRa_up_des_DH$SYS_ID), c(2,6)],
SaRa_DH[as.character(Intersect_SaRa_up_des_DH$SYS_ID), c(2,6)])
write.table(Intersect_SaRa_up_des_DH, file = "COMPILED_DATA/SET_DIFFERENCE/Intersect_SaRa_DH_up_des.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Intersect_list_SaRa_up_DH <- list(GO_SaRavsSalt2_DH_up_wo_GRG,
GO_SaRavsRapa_DH_up_wo_GRG)
library(ggvenn)
names(Intersect_list_SaRa_up_DH) <- c("SR_S","SR_R")
ggvenn(Intersect_list_SaRa_up_DH,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
length(Intersect_SaRa_up_DH)
dim(Intersect_SaRa_up_des_DH)
Intersect_SaRa_down_DH <- intersect(GO_SaRavsRapa_DH_down_wo_GRG, GO_SaRavsSalt2_DH_down_wo_GRG)
length(Intersect_SaRa_down_DH)
write.table(Intersect_SaRa_down_DH, file = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/Intersect_SaRa_DH_down.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = FALSE, quote = FALSE)
Intersect_SaRa_down_des_DH <- Gene_Description_DH[(Gene_Description_DH$SGD_DB_ID %in% as.character(na.omit(Intersect_SaRa_down_DH))), ]
str(Intersect_SaRa_down_des_DH)
Intersect_SaRa_down_des_DH <- cbind(Intersect_SaRa_down_des_DH,
salt2_DH[as.character(Intersect_SaRa_down_des_DH$SYS_ID), c(2,6)],
rapa_DH[as.character(Intersect_SaRa_down_des_DH$SYS_ID), c(2,6)],
SaRa_DH[as.character(Intersect_SaRa_down_des_DH$SYS_ID), c(2,6)])
write.table(Intersect_SaRa_down_des_DH, file = "COMPILED_DATA/SET_DIFFERENCE/Intersect_SaRa_down_des_DH.txt", sep = "\t", na = "NA", row.names = FALSE, col.names = TRUE, quote = FALSE)
Intersect_list_SaRa_down_DH <- list(GO_SaRavsSalt2_DH_down_wo_GRG,
GO_SaRavsRapa_DH_down_wo_GRG)
library(ggvenn)
names(Intersect_list_SaRa_down_DH) <- c("SR_S","SR_R")
ggvenn(Intersect_list_SaRa_down_DH,
fill_color = c("#0073C2FF", "#CD534CFF"),
stroke_size = 0.5,
set_name_size = 4)
library(org.Sc.sgd.db)
library(clusterProfiler)
library(AnnotationDbi)
go_enrichment <- function(input_file, background_file, p_value_threshold = 0.05){
input_genes <- read.table(file = input_file,
header = F,
stringsAsFactors = F)
input_genename <- bitr(input_genes[,1], fromType="SGD", toType="GENENAME", OrgDb="org.Sc.sgd.db")
background_genes_all <- read.table(file = background_file,
header = F,
stringsAsFactors = F)
background_genename_all <- bitr(background_genes_all[,1], fromType="SGD", toType="GENENAME", OrgDb="org.Sc.sgd.db")
Go_output_BP <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "BP", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
Go_output_MF <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "MF", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
Go_output_CC <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "CC", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
df = data.frame(matrix(nrow = 1, ncol = 9))
colnames(df) <- c("ID", "Description", "GeneRatio",	"BgRatio",	"pvalue",	"p.adjust",	"qvalue",	"geneID",	"Count")
go_terms <- rbind(as.data.frame(Go_output_BP), df, as.data.frame(Go_output_MF), df, as.data.frame(Go_output_CC))
output_file <- paste0("COMPILED_DATA/GO_OUTPUT_SC/GO_output_wo_GRG/", gsub(".txt", "_output.csv", basename(input_file)))
write.table(go_terms, file = output_file, sep = ",", row.names = F, col.names = T)
}
input_files <- list.files(path = "COMPILED_DATA/GO_GENE_LISTS_SC/GO_Input_wo_GRG/", pattern = ".txt", full.names = TRUE)
for (file in input_files) {go_enrichment(input_file = file, background_file = "COMPILED_DATA/GO_GENE_LISTS_SC/BACKGROUND_GENESET_SGD_DB_ID.txt", p_value_threshold = 0.1)}
library(org.Sc.sgd.db)
library(clusterProfiler)
library(AnnotationDbi)
go_enrichment <- function(input_file, background_file, p_value_threshold = 0.05){
input_genes <- read.table(file = input_file,
header = F,
stringsAsFactors = F)
input_genename <- bitr(input_genes[,1], fromType="SGD", toType="GENENAME", OrgDb="org.Sc.sgd.db")
background_genes_all <- read.table(file = background_file,
header = F,
stringsAsFactors = F)
background_genename_all <- bitr(background_genes_all[,1], fromType="SGD", toType="GENENAME", OrgDb="org.Sc.sgd.db")
Go_output_BP <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "BP", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
Go_output_MF <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "MF", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
Go_output_CC <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "CC", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
df = data.frame(matrix(nrow = 1, ncol = 9))
colnames(df) <- c("ID", "Description", "GeneRatio",	"BgRatio",	"pvalue",	"p.adjust",	"qvalue",	"geneID",	"Count")
go_terms <- rbind(as.data.frame(Go_output_BP), df, as.data.frame(Go_output_MF), df, as.data.frame(Go_output_CC))
output_file <- paste0("COMPILED_DATA/GO_OUTPUT_DH/GO_output_all/", gsub(".txt", "_output.csv", basename(input_file)))
write.table(go_terms, file = output_file, sep = ",", row.names = F, col.names = T)
}
input_files <- list.files(path = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input/", pattern = ".txt", full.names = TRUE)
for (file in input_files) {go_enrichment(input_file = file, background_file = "COMPILED_DATA/GO_GENE_LISTS_SC/Background_all.txt", p_value_threshold = 0.1)}
go_enrichment <- function(input_file, background_file, p_value_threshold = 0.05){
input_genes <- read.table(file = input_file,
header = F,
stringsAsFactors = F)
input_genename <- bitr(input_genes[,1], fromType="SGD", toType="GENENAME", OrgDb="org.Sc.sgd.db")
background_genes_all <- read.table(file = background_file,
header = F,
stringsAsFactors = F)
background_genename_all <- bitr(background_genes_all[,1], fromType="SGD", toType="GENENAME", OrgDb="org.Sc.sgd.db")
Go_output_BP <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "BP", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
Go_output_MF <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "MF", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
Go_output_CC <- enrichGO(gene = input_genename[,2], OrgDb = org.Sc.sgd.db, keyType = "GENENAME", ont = "CC", pvalueCutoff = p_value_threshold, universe = background_genename_all[,2])
df = data.frame(matrix(nrow = 1, ncol = 9))
colnames(df) <- c("ID", "Description", "GeneRatio",	"BgRatio",	"pvalue",	"p.adjust",	"qvalue",	"geneID",	"Count")
go_terms <- rbind(as.data.frame(Go_output_BP), df, as.data.frame(Go_output_MF), df, as.data.frame(Go_output_CC))
output_file <- paste0("COMPILED_DATA/GO_OUTPUT_DH/GO_output_all_wo_GRG/", gsub(".txt", "_output.csv", basename(input_file)))
write.table(go_terms, file = output_file, sep = ",", row.names = F, col.names = T)
}
input_files <- list.files(path = "COMPILED_DATA/GO_GENE_LISTS_DH/GO_Input_wo_GRG/", pattern = ".txt", full.names = TRUE)
for (file in input_files) {go_enrichment(input_file = file, background_file = "COMPILED_DATA/GO_GENE_LISTS_SC/BACKGROUND_GENESET_SGD_DB_ID.txt", p_value_threshold = 0.1)}
